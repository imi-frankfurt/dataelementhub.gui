FROM node:16.17.0-buster-slim
ENV DIR=/usr/src/dehub-gui
ARG KEYCLOAK_REALM
ENV KEYCLOAK_REALM=${KEYCLOAK_REALM}
ARG KEYCLOAK_CLIENT_ID
ENV KEYCLOAK_CLIENT_ID=${KEYCLOAK_CLIENT_ID}
ARG KEYCLOAK_URL
ENV KEYCLOAK_URL=${KEYCLOAK_URL}
ARG BASE_URL
ENV BASE_URL=${BASE_URL}
ARG BACKEND_URL
ENV BACKEND_URL=${BACKEND_URL}
RUN mkdir -p $DIR
WORKDIR $DIR
COPY . $DIR
RUN apt update && apt install -y python3 g++ build-essential
RUN npm install -g npm@8.15.0
RUN npm install
RUN npm run build
EXPOSE 3000
ENV NUXT_HOST=0.0.0.0
ENV NUXT_PORT=3000
CMD [ "npm", "run", "start" ]
